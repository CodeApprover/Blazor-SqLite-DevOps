---
name: "Development Success"

#  Confirms the success of the development workflow by publishing a success status for the related commit.

on:
  repository_dispatch:
    types: trigger-development-success

env:
  SHA: ${{ github.event.client_payload.sha }}
  SHA_BRANCH: ${{ github.event.client_payload.sha_branch }}
  CSPROJ: ${{ github.event.client_payload.csproj }}

jobs:
  succeed:
    name: Publish Development Success Status
    runs-on: ubuntu-latest
    timeout-minutes: 15
    #if: (github.actor != ${{ github.repository_owner }}) # prevents workflow

    steps:
    - name: Start Deployment
      uses: tallyb/deployments@master
      id: deployment
      with:
        step: start
        token: ${{ secrets.AUTH }}
        env: development

    - name: Update Deployment Status
      uses: Tallyb/deployments@0.5.0
      if: always()
      with:
        step: finish
        token: ${{ secrets.AUTH }}
        status: ${{ job.status }}
        deployment_id: ${{ steps.deployment.outputs.deployment_id }}
