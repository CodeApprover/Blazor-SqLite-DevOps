---
name: "Development Success"

#  Confirms the success of the development workflow by publishing a success status for the related commit.

on:
  repository_dispatch:
    types: trigger-development-success

env:
  SHA: ${{ github.event.client_payload.sha }}
  SHA_BRANCH: ${{ github.event.client_payload.sha_branch }}
  CSPROJ: ${{ github.event.client_payload.csproj }}

jobs:
  succeed:
    name: Development Success Confirmation
    runs-on: ubuntu-latest
    timeout-minutes: 15
    #if: (github.actor != 'CodeApprover')

    steps:

    - name: Publish success status
      run: |
        # Make a curl request to update the commit status
        curl -X POST \
        -H "Authorization: token ${{ secrets.AUTH }}" \
        -H "Accept: application/vnd.github.v3+json" \
        https://api.github.com/repos/${{ github.repository }}/statuses/${{ env.SHA }} \
        -d '{
          "state": "success",
          "description": "All development workflows succeeded.",
          "context": "status/${{ github.workflow }}"
        }' || exit 1
